type bool(b : ğ”¹) = ((1 âˆ§ [(b = F)]) + (1 âˆ§ [(b = T)]))
alg ixbool = (injâ‚ () â‡’ F â€– injâ‚‚ () â‡’ T)
type wbool(b : ğ”¹) = Î¼(I âŠ• I) âŠƒ ixbool â‡’ b
let false = (return injâ‚ <> : â†‘bool(F))
let true = (return injâ‚‚ <> : â†‘bool(T))

def bool_not : âˆ€b : ğ”¹ . (wbool(b) â†’ â†‘bool((b = F)))
             = Î»wx . match wx { into(x) â‡’ match x {
               injâ‚ f â‡’ return true
             â€– injâ‚‚ t â‡’ return false
             }}

def bool_and : âˆ€a : ğ”¹ . âˆ€b : ğ”¹ . (wbool(a) â†’ (wbool(b) â†’ â†‘bool(((a = T) âˆ§ (b = T)))))
             = Î»wx . Î»wy . match wx { into(x) â‡’ match x {
               injâ‚ f â‡’ return false
             â€– injâ‚‚ t â‡’ match wy { into(y) â‡’ return y }
             }}

def bool_or : âˆ€a : ğ”¹ . âˆ€b : ğ”¹ . (wbool(a) â†’ (wbool(b) â†’ â†‘bool(((a = T) âˆ¨ (b = T)))))
            = Î»wx . Î»wy . match wx { into(x) â‡’ match x {
              injâ‚ f â‡’ match wy { into(y) â‡’ return y }
            â€– injâ‚‚ t â‡’ return true
            }}

def bool_xor : âˆ€a : ğ”¹ . âˆ€b : ğ”¹ . (wbool(a) â†’ (wbool(b) â†’ â†‘bool(((a = T) â‰  (b = T)))))
             = Î»wx . Î»wy . match wx { into(x) â‡’ match x {
               injâ‚ f â‡’ match wy { into(y) â‡’ return y }
             â€– injâ‚‚ t â‡’ let result = bool_not(wy); return result
             }}
